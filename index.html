<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hatim Space | Ultimate KUL</title>
    <style>
        :root { --primary: #00ff41; --bg: #0a0a0a; --toolbar: #161616; --page: #ffffff; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #login-screen { position: fixed; inset: 0; background: black; z-index: 10000; display: flex; align-items: center; justify-content: center; }
        .login-card { background: #111; padding: 40px; border-radius: 20px; border: 1px solid var(--primary); text-align: center; width: 320px; }
        .login-card input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #333; background: #000; color: white; outline: none; }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø¯ÙˆØ§Øª (Word Style) */
        .toolbar { background: var(--toolbar); padding: 10px 20px; display: flex; gap: 8px; border-bottom: 1px solid #333; align-items: center; }
        .t-btn { background: #222; border: 1px solid #444; color: white; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 14px; }
        .t-btn:hover { background: var(--primary); color: black; }

        .main-container { flex: 1; display: flex; overflow: hidden; }
        
        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­Ø±Ø± (Notion Style) */
        .workspace { flex: 1; padding: 40px; overflow-y: auto; background: #1a1a1a; display: flex; justify-content: center; position: relative; }
        #editor { width: 100%; max-width: 800px; min-height: 1000px; background: var(--page); color: #222; padding: 60px; outline: none; border-radius: 4px; font-size: 18px; line-height: 1.6; box-shadow: 0 0 30px rgba(0,0,0,0.5); }
        
        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³Ù„Ø§Ø´ Ø§Ù„Ø³Ø­Ø±ÙŠØ© */
        #slash-menu { position: absolute; background: #1a1a1a; border: 1px solid var(--primary); border-radius: 8px; width: 200px; display: none; z-index: 1000; padding: 5px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .slash-item { padding: 10px; cursor: pointer; border-radius: 5px; font-size: 13px; transition: 0.2s; }
        .slash-item:hover { background: var(--primary); color: black; }

        /* Ø§Ù„Ø´Ø§Øª Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ */
        #chat-sidebar { width: 280px; background: #111; border-right: 1px solid #333; display: flex; flex-direction: column; }
        #chat-messages { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; }
        .msg { background: #1e1e1e; padding: 8px 12px; border-radius: 8px; border-right: 3px solid var(--primary); font-size: 13px; }
        .msg b { color: var(--primary); display: block; font-size: 11px; }
        .chat-input-area { padding: 15px; display: flex; gap: 5px; border-top: 1px solid #333; }
        #chat-input { flex: 1; background: #000; border: 1px solid #333; color: white; padding: 8px; border-radius: 4px; outline: none; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-card">
            <h2 style="color:var(--primary)">HATIM SPACE</h2>
            <input type="text" id="user-name" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ">
            <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (1234)">
            <button class="t-btn" style="width:100%; margin-top:10px;" onclick="startApp()">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <header class="toolbar">
        <span style="color:var(--primary); font-weight:bold; margin-left:15px;">ğŸª KUL LIVE</span>
        <button class="t-btn" onclick="exec('bold')"><b>B</b></button>
        <button class="t-btn" onclick="exec('italic')"><i>I</i></button>
        <button class="t-btn" onclick="exec('underline')"><u>U</u></button>
        <button class="t-btn" onclick="exec('insertUnorderedList')">â€¢ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
        <button class="t-btn" onclick="exec('justifyRight')">â¡ï¸ ÙŠÙ…ÙŠÙ†</button>
        <button class="t-btn" onclick="exec('justifyCenter')">â†”ï¸ ÙˆØ³Ø·</button>
    </header>

    <div class="main-container">
        <div id="chat-sidebar">
            <div id="chat-messages"></div>
            <div class="chat-input-area">
                <input type="text" id="chat-input" placeholder="Ø¯Ø±Ø¯Ø´Ø©..." onkeypress="if(event.key==='Enter') sendMsg()">
                <button class="t-btn" onclick="sendMsg()">â†—ï¸</button>
            </div>
        </div>

        <div class="workspace">
            <div id="editor" contenteditable="true" spellcheck="false">
                <h1>Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ©</h1>
                <p>Ø¬Ø±Ø¨ ÙƒØªØ§Ø¨Ø© / Ù„ØªØ¸Ù‡Ø± Ø®ÙŠØ§Ø±Ø§Øª Ù†ÙˆØ´ÙŠÙ†...</p>
            </div>
            <div id="slash-menu">
                <div class="slash-item" onclick="insert('h1')">ğŸ“ Ø¹Ù†ÙˆØ§Ù† ÙƒØ¨ÙŠØ± (H1)</div>
                <div class="slash-item" onclick="insert('todo')">âœ… Ù‚Ø§Ø¦Ù…Ø© Ù…Ù‡Ø§Ù… (To-do)</div>
                <div class="slash-item" onclick="insert('code')">ğŸ’» Ù…Ø±Ø¨Ø¹ ÙƒÙˆØ¯ Ø¨Ø±Ù…Ø¬ÙŠ</div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
        const firebaseConfig = {
          apiKey: "AIzaSyBYW9x3xQvcZugc0mJx5iFbByPtGkXNx4M",
          authDomain: "hatim-space-4f7e8.firebaseapp.com",
          projectId: "hatim-space-4f7e8",
          storageBucket: "hatim-space-4f7e8.firebasestorage.app",
          messagingSenderId: "1014020499692",
          appId: "1:1014020499692:web:37e023621b0ff9ee59ddc9"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let myName = "";

        function startApp() {
            const n = document.getElementById('user-name').value;
            if(n && document.getElementById('pass').value === "1234") {
                myName = n;
                document.getElementById('login-screen').style.display = 'none';
                listenChat();
            }
        }

        // Ø®Ø§ØµÙŠØ© Ø§Ù„Ø³Ù„Ø§Ø´ (Notion)
        const editor = document.getElementById('editor');
        const menu = document.getElementById('slash-menu');

        editor.addEventListener('keyup', (e) => {
            const selection = window.getSelection();
            const range = selection.getRangeAt(0);
            const textBefore = range.startContainer.textContent.slice(0, range.startOffset);
            
            if (textBefore.endsWith('/')) {
                const rect = range.getBoundingClientRect();
                menu.style.display = 'block';
                menu.style.top = (rect.top + window.scrollY + 25) + 'px';
                menu.style.left = rect.left + 'px';
            } else { menu.style.display = 'none'; }
        });

        function insert(type) {
            editor.focus();
            document.execCommand('delete', false, null); // Ø­Ø°Ù Ø§Ù„Ø³Ù„Ø§Ø´
            if(type === 'h1') document.execCommand('formatBlock', false, 'H1');
            if(type === 'todo') document.execCommand('insertHTML', false, '<div><input type="checkbox"> Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©...</div>');
            if(type === 'code') document.execCommand('insertHTML', false, '<pre style="background:#eee; padding:10px;">// Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§</pre>');
            menu.style.display = 'none';
        }

        // Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙˆÙˆØ±Ø¯ (Word)
        function exec(cmd) { document.execCommand(cmd, false, null); editor.focus(); }

        // Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© 
        function sendMsg() {
            const input = document.getElementById('chat-input');
            if(input.value) {
                db.ref('messages').push({ name: myName, text: input.value });
                input.value = "";
            }
        }

        function listenChat() {
            db.ref('messages').limitToLast(20).on('child_added', (s) => {
                const d = s.val();
                const div = document.createElement('div');
                div.className = "msg";
                div.innerHTML = `<b>${d.name}</b> ${d.text}`;
                document.getElementById('chat-messages').appendChild(div);
                document.getElementById('chat-messages').scrollTop = 10000;
            });
        }

        document.addEventListener('mousedown', (e) => { if(!menu.contains(e.target)) menu.style.display = 'none'; });
    </script>
</body>
</html>
