<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hatim Space | Organize your time</title>
    <style>
        :root { --primary: #00ff41; --bg: #0a0a0a; --toolbar: #161616; --page: #ffffff; --chat-bg: #111; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Segoe UI', Tahoma, sans-serif; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ */
        #login-screen { position: fixed; inset: 0; background: radial-gradient(circle, #1a1a1a 0%, #000 100%); z-index: 10000; display: flex; align-items: center; justify-content: center; }
        .login-card { background: rgba(20, 20, 20, 0.9); padding: 40px; border-radius: 20px; border: 1px solid var(--primary); text-align: center; width: 320px; backdrop-filter: blur(10px); box-shadow: 0 0 50px rgba(0, 255, 65, 0.1); }
        .login-card input { width: 100%; padding: 14px; margin: 10px 0; border-radius: 8px; border: 1px solid #333; background: #000; color: white; outline: none; box-sizing: border-box; }
        .btn-entry { width: 100%; padding: 14px; background: var(--primary); color: #000; font-weight: bold; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø¯ÙˆØ§Øª */
        .toolbar { background: var(--toolbar); padding: 10px 20px; display: flex; gap: 10px; border-bottom: 1px solid #333; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        .t-btn { background: #222; border: 1px solid #444; color: white; padding: 8px 15px; border-radius: 6px; cursor: pointer; transition: 0.2s; }
        .t-btn:hover { background: var(--primary); color: black; }

        /* ØªØ®Ø·ÙŠØ· Ø§Ù„ØµÙØ­Ø© */
        .main-container { flex: 1; display: flex; overflow: hidden; }
        
        /* Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
        #chat-sidebar { width: 320px; background: var(--chat-bg); border-right: 1px solid #333; display: flex; flex-direction: column; }
        .chat-header { padding: 15px; background: #1a1a1a; border-bottom: 1px solid #333; font-weight: bold; color: var(--primary); display: flex; justify-content: space-between; }
        #chat-messages { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 12px; }
        .msg { background: #1e1e1e; padding: 12px; border-radius: 10px; border-right: 3px solid var(--primary); font-size: 0.9rem; line-height: 1.4; }
        .msg b { color: var(--primary); display: block; font-size: 0.75rem; margin-bottom: 4px; letter-spacing: 0.5px; }
        .chat-input-area { padding: 15px; display: flex; gap: 8px; border-top: 1px solid #333; background: #0a0a0a; }
        #chat-input { flex: 1; background: #111; border: 1px solid #333; color: white; padding: 10px; border-radius: 6px; outline: none; }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­Ø±Ø± */
        .workspace { flex: 1; padding: 30px; overflow-y: auto; background: #151515; display: flex; justify-content: center; position: relative; }
        #editor { width: 100%; max-width: 850px; min-height: 1100px; background: var(--page); color: #222; padding: 70px; outline: none; border-radius: 4px; font-size: 18px; line-height: 1.8; box-shadow: 0 0 50px rgba(0,0,0,0.6); }

        footer { background: #000; padding: 10px 40px; border-top: 1px solid #222; display: flex; justify-content: space-between; font-size: 0.8rem; color: #666; }
    </style>
</head>
<body>

    <div id="login-screen">
        <div class="login-card">
            <h1 style="color:var(--primary); margin:0;">HATIM SPACE</h1>
            <p style="color:#666; margin-bottom:20px;">Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠØ© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø© (KUL)</p>
            <input type="text" id="visitor-name" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±">
            <input type="password" id="access-pass" placeholder="ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„ÙØ±ÙŠÙ‚ (1234)">
            <button class="btn-entry" onclick="entry()">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ù†ØµØ©</button>
            <p id="error" style="color:red; display:none; margin-top:10px;">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø®Ø§Ø·Ø¦Ø©</p>
        </div>
    </div>

    <header class="toolbar">
        <div style="font-weight:bold; color:var(--primary); font-size: 1.2rem; margin-left: 20px;">ğŸª HATIM SPACE</div>
        <button class="t-btn" onclick="document.execCommand('bold')"><b>B</b></button>
        <button class="t-btn" onclick="document.execCommand('italic')"><i>I</i></button>
        <button class="t-btn" onclick="document.execCommand('underline')"><u>U</u></button>
        <button class="t-btn" onclick="saveDoc()" style="background:#007bff">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¹Ù…Ù„</button>
        <div style="margin-right:auto; font-size:0.9rem; color:var(--primary)" id="user-display"></div>
        <button class="t-btn" onclick="location.reload()" style="background:#bd2130">ğŸšª Ø®Ø±ÙˆØ¬</button>
    </header>

    <div class="main-container">
        <div id="chat-sidebar">
            <div class="chat-header"><span>Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø­ÙŠØ©</span> <small id="status-dot">ğŸŸ¢ Ù…ØªØµÙ„</small></div>
            <div id="chat-messages"></div>
            <div class="chat-input-area">
                <input type="text" id="chat-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..." onkeypress="if(event.key==='Enter') sendMsg()">
                <button class="t-btn" onclick="sendMsg()">â†—ï¸</button>
            </div>
        </div>

        <div class="workspace">
            <div id="editor" contenteditable="true" spellcheck="false">
                <h1 style="text-align: center;">Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©</h1>
                <p>Ø£Ù‡Ù„Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ <b>Hatim Space</b>. Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ù†Ø§ ÙƒØªØ§Ø¨Ø© ØªÙ‚Ø§Ø±ÙŠØ±Ù†Ø§ ÙˆÙ…Ø´Ø§Ø±ÙŠØ¹Ù†Ø§ Ù…Ø¹Ø§Ù‹.</p>
                <hr>
            </div>
        </div>
    </div>

    <footer>
        <div>Ø§Ù„Ù…Ø¨Ø±Ù…Ø¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: <b style="color:var(--primary)">Hatim Ait Ijjou</b></div>
        <div>Hatim Space &copy; 2026 - Realtime Enabled</div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©
        const firebaseConfig = {
          apiKey: "AIzaSyBYW9x3xQvcZugc0mJx5iFbByPtGkXNx4M",
          authDomain: "hatim-space-4f7e8.firebaseapp.com",
          projectId: "hatim-space-4f7e8",
          storageBucket: "hatim-space-4f7e8.firebasestorage.app",
          messagingSenderId: "1014020499692",
          appId: "1:1014020499692:web:37e023621b0ff9ee59ddc9",
          measurementId: "G-Q3JX3NZKSB"
        };

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let userName = "";

        // ÙˆØ¸ÙŠÙØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        function entry() {
            const name = document.getElementById('visitor-name').value;
            const pass = document.getElementById('access-pass').value;
            if(name.trim() !== "" && pass === "1234") {
                userName = name;
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('user-display').innerText = "ğŸ‘¤ " + userName;
                listenMessages(); // Ø¨Ø¯Ø¡ Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
                // Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨ ÙÙŠ Ø§Ù„Ø´Ø§Øª
                db.ref('messages').push({ name: "Ø§Ù„Ù†Ø¸Ø§Ù…", text: "Ø§Ù†Ø¶Ù… " + userName + " Ø¥Ù„Ù‰ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¢Ù†.", time: Date.now() });
            } else {
                document.getElementById('error').style.display = 'block';
            }
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function sendMsg() {
            const input = document.getElementById('chat-input');
            if(input.value.trim() !== "") {
                db.ref('messages').push({
                    name: userName,
                    text: input.value,
                    time: Date.now()
                });
                input.value = "";
            }
        }

        // Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ø´Ø§Øª ÙÙˆØ±Ø§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ø¬Ù…ÙŠØ¹
        function listenMessages() {
            db.ref('messages').limitToLast(100).on('child_added', (snapshot) => {
                const data = snapshot.val();
                const msgDiv = document.createElement('div');
                msgDiv.className = "msg";
                msgDiv.innerHTML = `<b>${data.name}</b> ${data.text}`;
                const container = document.getElementById('chat-messages');
                container.appendChild(msgDiv);
                container.scrollTop = container.scrollHeight; // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„Ù„Ø£Ø³ÙÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
            });
        }

        // Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù
        function saveDoc() {
            const content = document.getElementById('editor').innerText;
            const blob = new Blob([content], {type: "text/plain"});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = "Hatim_Space_KUL.txt";
            a.click();
        }
    </script>
</body>
</html>
